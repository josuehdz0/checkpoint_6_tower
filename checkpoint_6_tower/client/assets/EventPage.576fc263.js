import{g,l as _,A as l,_ as I,h as C,w as j,b as y,P as r,i as f,j as w,c as s,a as t,n as S,k as u,t as v,F as k,r as E,m as A,q as B,v as D,u as L,o as c,s as N,p as P,e as T,x as V}from"./index.428d32a4.js";class x{constructor(o){this.id=o.id,this.body=o.body,this.creatorId=o.creatorId,this.eventId=o.eventId,this.creator=o.creator}}class O{async getCommentByEvent(o){const a=await g.get(`api/events/${o}/comments`);_.log("getting comments to event",a.data),l.comments=a.data.map(n=>new x(n))}async createComment(o){const a=await g.post("/api/comments",o);_.log("creating comment",a.data),l.comments.push(new x(a.data))}async deleteComment(o){const a=await g.delete("api/comments/"+o);_.log("deleing comment",a.data);const n=l.comments.findIndex(h=>h.id==o);_.log("test",n),n!==-1&&l.comments.splice(n,1)}}const b=new O;const q={setup(){const i=C({}),o=L(),a=V;async function n(){try{const e=o.params.eventId;await w.getOneEventById(e)}catch(e){r.error(e,"Getting Event By Id Error"),a.push("/")}}async function h(){try{const e=o.params.eventId;await f.getEventAttendees(e)}catch(e){r.error(e.message)}}async function p(){try{const e=o.params.eventId;await b.getCommentByEvent(e)}catch(e){r.error(e.message)}}return j(()=>{o.params.eventId&&(n(),h(),p())}),{editable:i,event:y(()=>l.event),attendees:y(()=>l.attendees),comments:y(()=>l.comments),account:y(()=>l.account),foundAttendee:y(()=>l.attendees.find(e=>e.id==l.account.id)),async createComment(){try{const e=i.value;e.eventId=o.params.eventId,await b.createComment(e),i.value={}}catch(e){_.log(e),r.error(e.message)}},async deleteComment(e){try{await r.confirm("You sure you want to delete this comment?")&&await b.deleteComment(e)}catch(m){_.error(m),r.error(m.message)}},async attendEvent(){try{await f.attendEvent({eventId:o.params.eventId})}catch(e){_.error(e),r.error(e.message)}},async declineEvent(e){try{await r.confirm("Are you sure you no longer want to attend this event?")&&await f.declineEvent(e)}catch(m){_.error(m),r.error(m.message)}},async cancelEvent(e){try{await w.cancelEvent(e)}catch(m){_.error(m),r.error(m.message)}}}}},d=i=>(P("data-v-27822134"),i=i(),T(),i),z={key:0,class:"EventPage container-fluid"},F={class:"row justify-content-center eventinfo"},M={class:"row infobackground rounded"},R={class:"col-md-5 pt-4 p-md-3 p-0 d-flex justify-content-center align-items-center"},U=["src"],G={class:"col-md-7 py-2 d-flex flex-column"},H={class:"row justify-content-end"},Y={key:0,class:"col-md-2 d-flex justify-content-end"},J={key:0,class:"btn-group"},K=d(()=>t("button",{class:"btn btn-primary btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"mdi mdi-dots-horizontal"})],-1)),Q={class:"dropdown-menu"},W={key:1,class:"col-md-2 d-flex justify-content-end"},X={class:"row justify-content-between py-2 border-bottom border-3"},Z={class:"col-md-6 col-6"},$={class:"col-md-4 col-6 d-flex justify-content-end"},ee={class:"row"},te={class:"mt-auto"},ne={key:0,class:"row justify-content-between py-2"},oe={key:0,class:"col-md-4 col-6"},se={key:1,class:"col-md-4 col-6 d-flex align-items-center"},ce=d(()=>t("b",{class:"text-warning"},"SOLD OUT",-1)),de=[ce],ie={class:"col-md-5 col-6 d-flex justify-content-end"},ae={key:0},re=["disabled"],le=d(()=>t("div",{class:"mdi mdi-human"}," Attend Event",-1)),me=[le],_e=d(()=>t("div",{class:"mdi mdi-human"}," Decline",-1)),ve=[_e],ye={key:1,class:"row justify-content-between py-2"},he=d(()=>t("h3",{class:"text-danger"}," EVENT HAS BEEN CANCELLED",-1)),ue=[he],ge={class:"row justify-content-center mx-md-5 m-2 border border-secondary rounded border-2 bg-light"},fe={key:0},be={key:0,class:"col-11 py-2"},pe=d(()=>t("b",null,"Attendees: ",-1)),we=["src","alt","title"],ke={key:1,class:"col-11 py-2 text-center"},Ee=d(()=>t("b",null,"Be the first to get tickets to this event!",-1)),xe=[Ee],Ie={key:1},Ce=d(()=>t("b",null,"Event Comments",-1)),je=[Ce],Se={class:"row justify-content-center mx-md-5 m-2 border border-secondary rounded border-2 bg-light"},Ae={class:"col-11"},Be={class:"row p-3 justify-content-end"},De={class:"form-floating"},Le=d(()=>t("label",{for:"floatingTextarea2",class:"ps-4"},"Comment here!",-1)),Ne=d(()=>t("div",{class:"col-md-3 d-flex justify-content-md-end"},[t("button",{type:"submit",class:"btn btn-primary my-3"},"Post Comment")],-1)),Pe={key:1,class:"row justify-content-center py-2"},Te=d(()=>t("h5",{class:"text-center"}," Login to post a comment ",-1)),Ve=[Te],Oe={class:"row justify-content-center border-top border-secondary border-2"},qe={class:"col-8 py-2"},ze=["src","alt","title"],Fe={key:0,class:"col-4 p-3 d-flex justify-content-end"},Me=["onClick"],Re=d(()=>t("div",{class:"mdi mdi-trash-can-outline"},null,-1)),Ue=[Re],Ge={key:1,class:"col-4 p-3 d-flex justify-content-end"},He={key:1};function Ye(i,o,a,n,h,p){return n.event?(c(),s("div",z,[t("div",F,[t("div",{class:"col-md-11 col-11 my-3 rounded",style:S({backgroundImage:`url(${n.event.coverImg})`})},[t("div",M,[t("div",R,[t("img",{src:n.event.coverImg,alt:"",class:"img-fluid eventimg rounded"},null,8,U)]),t("div",G,[t("div",null,[t("div",H,[n.account.id==n.event.creatorId?(c(),s("div",Y,[n.event.isCanceled?u("",!0):(c(),s("div",J,[K,t("ul",Q,[t("div",{class:"dropdowntext selectable ps-2",onClick:o[0]||(o[0]=e=>n.cancelEvent(n.event.id))}," Cancel Event ")])]))])):(c(),s("div",W))]),t("div",X,[t("div",Z,[t("h4",null,[t("b",null,v(n.event.name),1)]),t("p",null,[t("b",null,v(n.event.location),1)])]),t("div",$,[t("b",null,v(n.event.startDate),1)])]),t("div",ee,[t("p",null,v(n.event.description),1)])]),t("div",te,[n.event.isCanceled?(c(),s("div",ye,ue)):(c(),s("div",ne,[n.event.capacity>0?(c(),s("div",oe,v(n.event.capacity)+" Spots left",1)):(c(),s("div",se,de)),t("div",ie,[n.account.id?(c(),s("div",ae,[n.foundAttendee?(c(),s("button",{key:1,onClick:o[2]||(o[2]=e=>n.declineEvent(n.foundAttendee.ticketId)),class:"btn btn-danger"},ve)):(c(),s("button",{key:0,onClick:o[1]||(o[1]=e=>n.attendEvent()),disabled:n.event.isCanceled||n.event.capacity<=0,class:"btn btn-primary"},me,8,re))])):u("",!0)])]))])])])],4)]),t("div",ge,[n.account.id?(c(),s("div",fe,[n.attendees.length>=1?(c(),s("div",be,[pe,(c(!0),s(k,null,E(n.attendees,e=>(c(),s("img",{class:"img-fluid profileimg p-1",src:e.picture,alt:e.name+"picture",title:e.name},null,8,we))),256))])):(c(),s("div",ke,xe))])):(c(),s("div",Ie,je))]),t("div",Se,[t("div",Ae,[n.account.id?(c(),s("form",{key:0,onSubmit:o[4]||(o[4]=A(e=>n.createComment(),["prevent"]))},[t("div",Be,[t("div",De,[B(t("textarea",{"onUpdate:modelValue":o[3]||(o[3]=e=>n.editable.body=e),required:"",class:"form-control",placeholder:"Leave a comment here",id:"body",style:{height:"100px"},name:"body"},null,512),[[D,n.editable.body]]),Le]),Ne])],32)):u("",!0),n.account.id?u("",!0):(c(),s("div",Pe,Ve)),(c(!0),s(k,null,E(n.comments,e=>(c(),s("div",Oe,[t("div",qe,[t("img",{class:"img-fluid profileimg",src:e.creator.picture,alt:e.creator.name+"picture",title:e.creator.name},null,8,ze),N(" "+v(e.body),1)]),n.account.id==e.creatorId?(c(),s("div",Fe,[t("button",{onClick:m=>n.deleteComment(e.id),class:"btn btn-danger"},Ue,8,Me)])):(c(),s("div",Ge))]))),256))])])])):(c(),s("div",He," loading "))}const Ke=I(q,[["render",Ye],["__scopeId","data-v-27822134"]]);export{Ke as default};
